

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Topic 18: Inference for Comparing Many Group Means (ANOVA)   Learning Strategies</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Learning Strategies">
<meta property="og:title" content="Topic 18: Inference for Comparing Many Group Means (ANOVA)">


  <link rel="canonical" href="http://localhost:4000/files/Shiny%20Tutorials/18_ANOVA/18_ANOVA.Rmd">
  <meta property="og:url" content="http://localhost:4000/files/Shiny%20Tutorials/18_ANOVA/18_ANOVA.Rmd">







  

  












  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "BPR Project",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Learning Strategies Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="http://localhost:4000/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="http://localhost:4000/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="http://localhost:4000/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="http://localhost:4000/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="http://localhost:4000/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="http://localhost:4000/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="http://localhost:4000/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="http://localhost:4000/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="http://localhost:4000/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="http://localhost:4000/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="http://localhost:4000/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/">Learning Strategies</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/syllabus/">Syllabus</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/slides/">Slides</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/labs/">Statistical Computing Labs</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/tutorials/">R Tutorials</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/dap/">Data Analysis Project</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/workshop/">Faculty Workshop</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/manual/">Implementation Manual</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4000/research/">Research/Publication</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="https://ncatregister.com/wp-content/uploads/2019/02/NCAT-Aggie.jpg" alt="BPR Project">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">BPR Project</h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
      
      
      
      
       
      
      
      
      
      
      
      
      
      
        <li><a href="https://github.com/IntroToStatNCAT/BPRProject.github.io"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Topic 18: Inference for Comparing Many Group Means (ANOVA)">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Topic 18: Inference for Comparing Many Group Means (ANOVA)
</h1>
          
        
        
        
        
             
        
    
        </header>
      

      <section class="page__content" itemprop="text">
        ```{r setup, include=FALSE}
#knitr::opts_chunk$set(eval = FALSE)
library(dplyr)
library(ggplot2)
library(learnr)
library(gradethis) #remotes::install_github("rstudio/gradethis")
library(learnrhash) #devtools::install_github("rundel/learnrhash")

tutorial_options(exercise.timelimit = 60, exercise.checker = gradethis::grade_learnr)

#knitr::opts_chunk$set(eval = FALSE)
```

If you've never coded before (or even if you have), type `print("Your Name")` in the interactive R chunk below and run it by hitting `crtl+Enter` or `cmd+Enter` for MAC users.

```{r Student-Name, exercise = TRUE}

```


## ANalysis Of VAriance (ANOVA)

In this workbook, we consider a method for comparing means from multiple groups. We will use a very famous dataset which contains measurements on several varieties of iris (a type of flower). The flowers are classified as *setosa*, *versicolor*, and *virginica*. You can see a photo of each below. In this workbook we will try to identify whether the iris dataset provides significant evidence to suggest a difference in the average petal widths across the three varieties.

###

<center>
<img src="images/iris.png" alt="drawing" width="75%"/>
</center>

###

Notice that none of the tools we've been exposed to can be applied directly to help us answer this question. Our hypothesis testing strategies have been limited to comparing numerical measures across one or two populations, but not more. We could apply three separate *one-versus-one* tests (versicolor versus setosa, versicolor versus virginica, and setosa versus virginica), but notice that the probability of an erroneous conclusion explodes. For example, at a 5% level of significance, the probability of making at least one Type I error (an incorrect conclusion of a significant difference) with three comparisons is now $1 - \left(0.95^3\right) \approx 14.26\%$. While it is possible to adjust the level of significance for the individual tests to correct for this, a better option is to conduct an ANalysis Of VAriance -- an ANOVA test.

###

Watch the video below from Dr. Mine &Ccedil;etinkaya-Rundel introducing ANOVA.

<center><iframe width="560" height="315" src="https://www.youtube.com/embed/W36DMVJ4Ibo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></center>

###

Dr. &Ccedil;etinkaya-Rundel's explanation in the video went through all of the nitty gritty details of ANOVA. You'll answer a few questions to help you think about what Dr. &Ccedil;etinkaya-Rundel was discussing and hopefully better understand the mechanics of ANOVA. What you really need to remember, however, is that 

+ ANOVA can be used to test whether there is evidence of a significant difference in means across multiple (three or more) populations. 
+ Test statistics resulting from ANOVA do not follow the normal or $T$-distribution, they follow an $F$-distribution instead.
+ The $p$-value resulting from an $F$-distribution is the area from our computed $F$-statistic and into the upper tail of the $F$-distribution. 
  
  + The interpretation of the $p$-value is exactly as it was for our earlier hypothesis tests -- the probability of observing a sample at least as extreme as ours under the assumption that the null hypothesis is true.
  
###

Let's answer a few questions. You can use the code block below to explore the `iris` dataset as you answer the questions that follow.

```{r quiz-anova-playground, exercise = TRUE}

```

```{r quiz-anova, echo = FALSE}
quiz(
  question_radio(
    "Which of the following are the hypotheses associated with our test to determine whether the `iris` data provides significant evidence of a difference in average petal widths across the three varieties of iris?",
    answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{setosa}} = \\mu_{\\text{versicolor}} = \\mu_{\\text{virginica}}\\\\ H_a: & \\text{At least one of the varieties has a different average petal width than the others.}\\end{array}$", correct = TRUE),
    answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{setosa}} = \\mu_{\\text{versicolor}} = \\mu_{\\text{virginica}}\\\\ H_a: & \\text{All of the varieties have different average petal widths than the others.}\\end{array}$"),
    answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{setosa}} = \\mu_{\\text{versicolor}} = \\mu_{\\text{virginica}}\\\\ H_a: & \\mu_{\\text{setosa}} \\neq \\mu_{\\text{versicolor}} \\neq \\mu_{\\text{virginica}}\\end{array}$"),
    answer("$\\begin{array}{ll} H_0: & \\mu_{\\text{setosa}} = \\mu_{\\text{versicolor}} = \\mu_{\\text{virginica}} = 0\\\\ H_a: & \\mu_{\\text{setosa}} \\neq \\mu_{\\text{versicolor}} \\neq \\mu_{\\text{virginica}} \\neq 0\\end{array}$"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "How many *groups* are involved in this hypothesis test?",
    answer("3", correct = TRUE),
    answer("2"),
    answer("1"),
    answer("4"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "How many *degrees of freedom* due to groups do we have?",
    answer("2", correct = TRUE),
    answer("3"),
    answer("1"),
    answer("4"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "Use the code block above to determine how many observations we have in our `iris` dataset. Use this information to determine the *total degrees of freedom*.",
    answer("149", correct = TRUE),
    answer("150"),
    answer("100"),
    answer("99"),
    answer("3"),
    answer("2"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Good work so far. Were you confident about your responses on the previous questions? If not, be sure to ask a question!

In her video, Dr. &Ccedil;etinkaya-Rundel mentions that the computations associated with an ANOVA test are tedious and prone to errors. For this reason, we typically utilize software to run ANOVA tests -- this is exactly what you'll do now.

###

We can run an ANOVA test to compare multiple group means using R's `aov()` function. We'll pass the function a single argument in the form of a formula. Store the result of running `aov(iris$Petal.Width ~ iris$Species)` in an object called `ANOVAtable` and then view the results of the ANOVA test by running `summary()` on this object. Use the results to answer the questions that follow.

```{r run-anova, exercise = TRUE}

```

```{r anova-test-interp, echo = FALSE}
quiz(
  question_radio(
    "How are the `Mean Sq` values related to the other values in the ANOVA table?",
    answer("The `Mean Sq` value is obtained by dividing the `Sum Sq` (sum of squared deviations) by the `Df` (degrees of freedom).", correct = TRUE),
    answer("The `Mean Sq` value is the `F value` divided by the `Sum Sq` (sum of squared deviations)."),
    answer("The `Mean Sq` value is unrelated to the other values in the ANOVA table and are just output by the software as meaningful values."),
    answer("The `Mean Sq` values are related to the product between the `F value` and the `p value`"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "What is the test statistic associated with the ANOVA test?",
    answer("960", correct = TRUE),
    answer("2e-16"),
    answer("40.21"),
    answer("2 and 147"),
    answer("There is no test statistic associated with an ANOVA test."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "What is the p-value associate with the ANOVA test?",
    answer("0.05"),
    answer("0.10"),
    answer("0.04"),
    answer("A number smaller than 0.0000000000000002", correct = TRUE),
    answer("-14"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "What is the conclusion associated with the ANOVA test?",
    answer("The p-value is less than the level of significance, so we reject the null hypothesis and accept the alternative.", correct = TRUE),
    answer("The p-value is less than the level of significance, so we fail to reject the null hypothesis."),
    answer("The p-value is less than the level of signficance, so we accept the null hypothesis."),
    answer("The p-value is at least as large as the level of significance, so we fail to reject the null hypothesis."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  question_radio(
    "What is the conclusion interpreted in the context of our original question?",
    answer("The iris data provides significant evidence to suggest that the average petal width is not the same across all three varieties of iris.", correct = TRUE),
    answer("The iris data provides signficant evidence to suggest that the average petal width is the same across all three varieties of iris."),
    answer("The iris data does not provide significant evidence to suggest that the average petal width differs in at least one of the varieties."),
    answer("The iris data provides significant evidence to suggest that all three varieties of iris have different average petal widths."),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

###

Notice that the result of the ANOVA test suggested that *at least one of the varieties has a different population mean than the other two varieties*. Unfortunately ANOVA doesn't tell us which one. There are methods which can be used to determine which groups have means that differ from one another but those are beyond the scope of this workbook. Interested individuals should look up the *Tukey Test* and *Bonferroni Correction*.

###

Use the code block below to construct side-by-side boxplots of petal width across each of the varieties of iris. Can you identify from the boxplot which of the varieties have different average petal widths? Note that you will not be able to do this in general.

```{r boxplot, exercise = TRUE}

```

### Submit

```{r context="server"}
learnrhash::encoder_logic(strip_output = TRUE)
```

```{r encode, echo=FALSE}
learnrhash::encoder_ui(
  ui_before = shiny::div(
    "If you have completed this tutorial and are happy with all of your",
    "solutions, please click the button below to generate your hash and",
    "submit it using the corresponding tutorial assignment tab on Blackboard",
    shiny::tags$br()
  ), 
  ui_after = shiny::tags$a(href = "https://blackboard.ncat.edu/", "NCAT Blackboard")
)
```

### Summary

Good work. Through this workbook you developed the ability to conduct a hypothesis test which compares many group means (more than two). 

+ ANOVA tests can be used to determine whether significant evidence exists to suggest that at least one group has a mean which differs from another group. 
+ We saw that ANOVA tests use the F-distribution and are typically conducted via software but that the mechanics of hypothesis testing remain the same. 
+ We also saw that we can conduct ANOVA tests in R using the `aov()` function.
+ Remember that ANOVA can indicate that at least one group mean significantly differs from another, but we need further analysis to determine which group means differ significantly.

        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      

      


    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/IntroToStatNCAT/BPRProject.github.io"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 BPR Project. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  </body>
</html>

